PREFIX string: <http://www.w3.org/2000/10/swap/string#>
PREFIX list: <http://www.w3.org/2000/10/swap/list#>
PREFIX log: <http://www.w3.org/2000/10/swap/log#>
PREFIX e: <http://eulersharp.sourceforge.net/2003/03swap/log-rules#>
PREFIX re: <http://josd.github.io/eye/reasoning#>

{   ?TEST re:outcome ?OUTCOME.
} <= {
    ("directory_files" "./" ?FILES) e:derive true.
    ("atomify" ?LIST ?FILES) e:derive true.
    ?LIST list:member ?TEST.
    ?TEST string:endsWith "pl".
    ?TEST log:notEqualTo "retina.pl".
    ("tpl -q --ns " ?TEST " 2>/dev/null | grep 'true.' | wc -l > out.txt") string:concatenation ?CMD.
    ("exec" ?CMD 0) e:derive true.
    "out.txt" e:fileString ?OUT.
    (("1" re:PASSED) ("0" re:FAILED)) list:member (?OUT ?OUTCOME).
    ("exec" "rm out.txt" 0) e:derive true.
}.
